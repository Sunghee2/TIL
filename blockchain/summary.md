# BlockChain

화폐의 실체는 믿음이다. 금으로 교환해 준다는 보장은 사라졌지만 화폐로 여전히 치킨을 먹고 맥주를 마실 수 있다고 모두가 믿고 있다. 화폐는 모두의 '신뢰'를 받고 있는 것이다. 비트코인이 암호'화폐'와 같은 용어를 달고 있는 이유도 '신뢰'할 만한 대상이 될 수 있기 때문이다. 그리고 그 신뢰의 원천이 바로 블록체인 이다.

- **블록체인, 거대한 분산 공개 장부**

  송금 과정은 은행에서 수행되며 그 기록도 은행에 저장된다. 이런 조치를 위해서는 보안을 위해 많은 비용이 수반된다. 하지만 블록체인은 거래 정보를 감추지 않고 모두에게 공개하고 누구나 거래 정보를 생성할 수 있으며 거래 정보를 모두에게 복사해 사본을 저장하고 그 사본끼리 내용을 서로 맞춘다. 수천~수만중화 처리로 기록이 사라지는 일을 원천적으로 막고 내용이 맞지 않는 사본은 폐기하는 것이다. 그래서 블록체인을 거대한 '분산 공개 장부'라고 부르기도 한다. 

  이렇게 기록이 없어지는 것을 막을 수 있지만 이것만으로는 기록의 위 변조까지 막을 수는 없다. 또한 거래의 진위 여부를 확인할 수도 없다. 이는 암호학의 도움을 받아 해결한다. 

- **모든 거래 정보에 디지털 서명 포함**

  인터넷 뱅킹을 이용해 송금할 때 우리는 공인인증서를 사용하는데 이것이 바로 디지털 서명이다. 디지털 서명을 통해 그 송금이 진본이라는 것을 입증할 수 있고 송금 사실을 나중에 부인할 수 없게 된다. 이것은 암호학을 바탕으로 만들어져 있다. 블록체인에 담겨 있는 모든 거래 정보에는 디지털 서명이 포함되어 있어 거래 정보가 진본이라는 것을 신뢰할 수 있다. 

  ![img](http://magazine.hankyung.com/magazinedata/images/photo/201802/7a909e27d6ec8ee9d2146d555945f8c9.jpg)

  하나의 블록에는 여러 개의 거래가 포함된다. 비트코인 블록 하나에는 약 2000개의 거래 정보가 포함될 수 있고 블록 하나의 물리적인 크기는 약 1MB다. 블록은 블록 헤더와 거래 정보, 기타 정보로 구성된다. 블록 헤더는 또 소프트웨어 버전, 앞 블록의 고유 번호, 블록 내 모든 거래 정보의 해시 값, 블록 생성 시작 시간, 난이도, 난스(Nonce: Number used once) 등 6가지 정보로 구성된다. 거래 정보는 다수의 입출금 거래 정보로 구성된다. 기타 정보에는 블록 헤더와 거래 정보에 포함되지 않는 데이터로 구성된다.

  블록체인은 이러한 블록들이 이어져 만들어진 블록의 집합체다. 블록 헤더의 앞 블록의 블록 고유번호를 기준으로 블록들이 이어져 있다. 

- 블록체인의 핵심, 1. 작업 증명과 보상

  블록체인이 신뢰의 원천이 될 수 있는 첫째 핵심 요소는 작업 증명(POW: Proof of Work)이다. 흔히 '어려운 수학 문제를 푼다'정도로 설명되기도 하는데 작업 증명은 새로 만든 블록의 고유 번호를 계산하고 새 블록을 블록체인에 이어 붙이는 작업을 완료했다는 것을 증명하는 것이다. 수학 문제는 결국 블록의 고유 번호를 계산하는 것을 말한다. 고유 번호를 계산하는 이유는 고유 번호가 있어야 블록을 블록체인에 연결할 수 있기 때문이다. 블록의 고유 번호는 hash라는 함수를 통해 계산된다.

   다행히 블록체인을 이해하는데 해시 함수를 수학적으로 분석할 필요는 없다. 패스트푸드점에서 흔히 볼 수 있는 해시브라운을 떠올려보자. 감자를 으깨고(hash) 튀기면 해시브라운이 나온다. 똑같은 감자를 으깨고 튀기면 언제나 똑같은 맛과 크기의 해시브라운이 나온다. 하지만 반대로 해시브라운을 다시 감자로 만들 수는 없다. 그래서 어떤 감자를 으깨야 특정한 맛과 크기의 해시브라운이 나오는지 추측할 수 없다. 특정한 맛과 크기의 해시브라운을 얻으려면 감자를 여러 번 바꿔 가면서 으깨고 튀겨본 후 맛과 크기를 비교해 볼 수밖에 없다. 감자와 해시브라운 사례를 통해 입력 값이 같으면 해시의 계산 결과 값은 항상 같게 나온다는 것을 이해할 수 있다. 또 특정 값이 나오는 입력 값을 예측할 수 없고 그래서 직접 계산해 보지 않고서는 답을 구할 수 없다는 것도 파악할 수 있다.

   해시 계산을 한 차례 수행하는 것은 어렵거나 오래 걸리는 일이 아니지만 특정 조건을 만족시키는 해시 계산 값이 나오게 하는 입력 값을 구하려면 상당히 많은 횟수의 계산을 반복해야 한다. 시간도 오래 걸린다. 하지만 입력 값을 구했다면 그 입력 값으로 해시를 계산한 결과가 특정 조건을 만족시키는지 확인하는 일은 아주 쉽다. 입력 값이 같으면 해시 계산 결과 값은 항상 같기 때문에 해시 계산 한 차례만 수행한 후 그 결과 값이 특정 조건을 만족시키는지 확인하면 된다. 해시 함수의 특징을 정리하면 답을 구하는 데 오랜 시간이 걸리지만 구한 답이 맞는지 검증하기는 매우 쉽다는 것이다.

   이러한 특징 때문에 블록의 고유 번호를 계산할 때 해시 함수를 사용한다. 아무 해시 값이나 블록의 고유 번호가 될 수 있는 것은 아니다. 어떤 입력 값을 넣고 해시를 계산한 결과가 특정 조건을 만족시켜야 그 해시의 계산 결과 값이 블록의 고유 번호가 될 수 있다. 그러면 입력 값과 특정 조건이 무엇인지 알아봐야 한다.

   블록의 고유 번호 역할을 하는 블록 해시는 버전, 앞 블록의 블록 해시, 블록 내 모든 거래 정보의 해시, 블록 생성 시각, 난이도, 난스 등 6가지 블록 헤더 정보를 입력 값ㄷ으로 하고 SHA256해시 함수로 계산한 값으로, 32바이트의 숫자 값이다. 